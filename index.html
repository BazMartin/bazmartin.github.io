<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LSCS ¬∑ Action Report</title>
  <!-- Poppins + orange/white professional vibe -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Poppins', sans-serif;
      background: #f4f5f7;   /* soft grey background ‚Äì white card pops */
      color: #1e2b37;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      line-height: 1.5;
    }

    header {
      background: #ffffff;
      padding: 16px 28px;
      border-bottom: 4px solid #f6861f;  /* LSCS orange */
      box-shadow: 0 4px 12px rgba(0,0,0,0.04);
    }

    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
    }

    .logo-area {
      display: flex;
      align-items: center;
      gap: 18px;
    }

    .logo-icon {
      font-size: 2.8rem;
      color: #f6861f;
    }

    .logo-text h1 {
      font-size: 2rem;
      font-weight: 700;
      letter-spacing: 1px;
      color: #1e2b37;
      line-height: 1.2;
    }

    .logo-text .badge {
      font-size: 1rem;
      font-weight: 500;
      color: #f6861f;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .report-ref {
      background: #f0f3f7;
      padding: 10px 22px;
      border-radius: 40px;
      border-left: 5px solid #f6861f;
      font-weight: 600;
      box-shadow: 0 2px 6px rgba(0,0,0,0.02);
      color: #1e2b37;
      font-size: 1.1rem;
    }

    .report-ref i {
      color: #f6861f;
      margin-right: 8px;
    }

    main {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 30px 20px;
    }

    /* white card, orange accent */
    .action-card {
      background: #ffffff;
      width: 100%;
      max-width: 1100px;
      border-radius: 32px;
      box-shadow: 0 20px 30px -10px rgba(0,0,0,0.15);
      border-bottom: 6px solid #f6861f;
      padding: 36px 40px;
    }

    .form-header {
      margin-bottom: 30px;
      border-left: 8px solid #f6861f;
      padding-left: 22px;
    }

    .form-header h2 {
      font-size: 2.2rem;
      font-weight: 600;
      color: #1e2b37;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .form-header h2 i {
      color: #f6861f;
      font-size: 2.2rem;
    }

    .form-header p {
      color: #4a5f73;
      margin-top: 8px;
      font-size: 1.05rem;
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    /* single‚Äëline fields: each field row uses flex for inline label+input */
    .form-container {
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .field-row {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 12px;
      background: #f9fafc;
      padding: 6px 16px 6px 10px;
      border-radius: 60px;
      border: 1px solid #e2e8f0;
      transition: 0.15s;
    }
    .field-row:focus-within {
      border-color: #f6861f;
      box-shadow: 0 0 0 3px rgba(246,134,31,0.15);
    }

    .field-row label {
      font-weight: 600;
      font-size: 0.95rem;
      min-width: 150px;
      color: #2c3e4f;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .field-row label i {
      width: 22px;
      color: #f6861f;
      font-size: 1.1rem;
    }

    .field-row input,
    .field-row select,
    .field-row textarea {
      flex: 1;
      min-width: 240px;
      background: white;
      border: 1px solid #d0dae6;
      border-radius: 40px;
      padding: 12px 20px;
      font-family: 'Poppins', sans-serif;
      font-size: 0.95rem;
      color: #1e2b37;
      resize: vertical;
    }

    .field-row textarea {
      border-radius: 24px;
      line-height: 1.4;
    }

    .field-row input:focus,
    .field-row select:focus,
    .field-row textarea:focus {
      border-color: #f6861f;
      outline: none;
    }

    /* badge prefix hint */
    .badge-hint {
      background: #f0f3f7;
      border-radius: 40px;
      padding: 6px 16px;
      font-size: 0.9rem;
      color: #1e2b37;
      white-space: nowrap;
    }
    .badge-hint i {
      color: #f6861f;
      margin-right: 4px;
    }

    /* conditional (other reason) small field */
    .other-reason-field {
      display: none;
      margin-top: 8px;
      margin-left: 50px;
      background: #ffffff;
      border: 1px dashed #f6861f;
      border-radius: 40px;
      padding: 10px 20px;
      align-items: center;
      gap: 15px;
    }
    .other-reason-field.active {
      display: flex;
    }
    .other-reason-field label {
      font-weight: 500;
      color: #1e2b37;
      min-width: 100px;
    }
    .other-reason-field input {
      flex: 1;
      background: white;
      border: 1px solid #d0dae6;
      border-radius: 30px;
      padding: 10px 16px;
    }

    /* divider */
    .section-divider {
      margin: 20px 0 10px;
      border: none;
      height: 2px;
      background: linear-gradient(90deg, #f6861f20, #f6861f, #f6861f20);
    }

    .submit-area {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 30px;
      margin-top: 30px;
      flex-wrap: wrap;
    }

    .submit-btn {
      background: #f6861f;
      border: none;
      color: white;
      font-weight: 700;
      font-size: 1.4rem;
      padding: 18px 46px;
      border-radius: 60px;
      cursor: pointer;
      box-shadow: 0 6px 0 #b1580e;
      transition: 0.12s;
      display: inline-flex;
      align-items: center;
      gap: 12px;
      letter-spacing: 1px;
    }

    .submit-btn i {
      font-size: 1.6rem;
    }

    .submit-btn:hover {
      background: #ff983d;
      transform: translateY(-3px);
      box-shadow: 0 9px 0 #b1580e;
    }

    .submit-btn:active {
      transform: translateY(4px);
      box-shadow: 0 2px 0 #b1580e;
    }

    .response-message {
      font-weight: 600;
      padding: 14px 24px;
      border-radius: 60px;
      background: #edf2f7;
    }

    .response-success {
      color: #0f5c2e;
      background: #e0ffe6;
    }
    .response-error {
      color: #a13020;
      background: #ffe6e0;
    }

    footer {
      background: white;
      padding: 18px;
      text-align: center;
      color: #556b7c;
      font-size: 0.95rem;
      border-top: 2px solid #f6861f30;
      margin-top: auto;
    }

    /* dynamic visibility for parking/city fields */
    .parking-fields, .city-fields {
      display: none;
    }
    .show-parking .parking-fields {
      display: block;
    }
    .show-city .city-fields {
      display: block;
    }

    /* extra inline grouping */
    .nested-rows {
      display: flex;
      flex-direction: column;
      gap: 12px;
      width: 100%;
    }

    @media (max-width: 800px) {
      .action-card { padding: 24px 18px; }
      .field-row { border-radius: 30px; }
    }
  </style>
</head>
<body>

<header>
  <div class="header-content">
    <div class="logo-area">
      <i class="fas fa-clipboard-list logo-icon"></i>
      <div class="logo-text">
        <h1>LSCS ¬∑ ACTION REPORT</h1>
        <div class="badge"><i class="fas fa-bolt"></i> OFFICIAL ¬∑ LOS SANTOS CITY SERVICES</div>
      </div>
    </div>
    <div class="report-ref">
      <i class="fas fa-qrcode"></i> <span id="headerReportCode">LSCS-0000</span>
    </div>
  </div>
</header>

<main>
  <div class="action-card" id="actionCard">
    <div class="form-header">
      <h2>
        <i class="fas fa-pen-to-square"></i> Field Action Report
      </h2>
      <p>
        <i class="fas fa-circle-info" style="color:#f6861f;"></i>
        All lines are single ¬∑ complete each field
      </p>
    </div>

    <form id="actionForm" class="form-container">
      <!-- UNIQUE REPORT CODE (random LSCS-XXXX) -->
      <div class="field-row">
        <label><i class="fas fa-hashtag"></i> Report code</label>
        <input type="text" id="reportCode" name="reportCode" readonly value="LSCS-0000" style="background:#f2f2f2; font-weight:600;">
      </div>

      <!-- ACTION TYPE DROPDOWN (Parking / City) -->
      <div class="field-row">
        <label><i class="fas fa-bolt"></i> Action type</label>
        <select id="actionType" name="actionType" required>
          <option value="" disabled selected>‚Äî select one ‚Äî</option>
          <option value="parking">üöó Parking Action</option>
          <option value="city">üèôÔ∏è City Action</option>
        </select>
      </div>

      <!-- ========== PARKING ACTION FIELDS ========= -->
      <div class="parking-fields" id="parkingFields">
        <div class="nested-rows">
          <div class="field-row">
            <label><i class="far fa-calendar-alt"></i> Date & Time</label>
            <input type="datetime-local" id="parkingTimestamp" name="parkingTimestamp">
          </div>
          <div class="field-row">
            <label><i class="fas fa-map-pin"></i> Location</label>
            <input type="text" id="parkingLocation" placeholder="e.g., Vespucci Blvd & Palomino" >
          </div>
          <div class="field-row">
            <label><i class="fas fa-gavel"></i> Guideline</label>
            <select id="parkingGuideline">
              <option value="">‚Äî select PRK code ‚Äî</option>
              <option>PRK001.1: Directly on an intersection, crosswalk or within 5 feet of an intersection or crosswalk.</option>
              <option>PRK001.2: Vehicle abandonment on a sidewalk or intersection.</option>
              <option>PRK001.3: Vehicle abandonment on a roadway</option>
              <option>PRK001.4: Parked with THREE or more wheels on the sidewalk.</option>
              <option>PRK001.5: Parked in front of, or within 5 feet of a Bus Stop, thus preventing flow of traffic.</option>
              <option>PRK001.6: Parked in a marked No-Parking Zone or areas where such signage is visible.</option>
              <option>PRK001.7: Vehicle abandonment within Pay-2-Park lots without payment.</option>
              <option>PRK001.8: Parked in tunnels where such parking would pose a hazard.</option>
              <option>PRK001.9: Parked on the interstate, posing a hazard.</option>
              <option>PRK001.10: Vehicle blocking Emergency Services, Emergency Exits or Fire Lanes.</option>
              <option>PRK001.11: Vehicle abandonment posing a risk.</option>
              <option>PRK002.1: Vehicle parked in a Pay-2-Park zone with an expired ticket.</option>
              <option>PRK002.2: Vehicle parked against flow of traffic.</option>
              <option>PRK002.3: Vehicle parked during snowplowing periods.</option>
              <option>PRK002.4: Vehicle parked outside of marked space.</option>
              <option>PRK002.5: Vehicle parked in a construction only zone.</option>
              <option>PRK002.6: Vehicle parked without required permit.</option>
              <option>PRK003.1: Requested By LSPD</option>
              <option>PRK003.2: Requested By LSFD</option>
            </select>
          </div>
          <div class="field-row">
            <label><i class="fas fa-car"></i> Vehicle Description</label>
            <input type="text" id="parkingVehicle" placeholder="e.g., yellow Sultan / plate 4X 5FH" >
          </div>
          <div class="field-row">
            <label><i class="fas fa-camera"></i> Photographic Evidence</label>
            <textarea id="parkingPhoto" rows="1" placeholder="imgur link / description (full URL)"></textarea>
          </div>
        </div>
      </div>

      <!-- ========== CITY ACTION FIELDS ========= -->
      <div class="city-fields" id="cityFields">
        <div class="nested-rows">
          <div class="field-row">
            <label><i class="far fa-calendar-alt"></i> Date & Time</label>
            <input type="datetime-local" id="cityTimestamp" name="cityTimestamp">
          </div>
          <div class="field-row">
            <label><i class="fas fa-map-pin"></i> Location</label>
            <input type="text" id="cityLocation" placeholder="street / district" >
          </div>
          <div class="field-row">
            <label><i class="fas fa-tasks"></i> Action Taken</label>
            <select id="cityActionTaken">
              <option value="">‚Äî select ‚Äî</option>
              <option value="Graffiti Removal">Graffiti Removal</option>
              <option value="Road Closure">Road Closure</option>
              <option value="Road Disruption">Road Disruption</option>
              <option value="Trashcan Empty">Trashcan Empty</option>
              <option value="Trashcan Removal">Trashcan Removal</option>
              <option value="Other">Other (click below)</option>
            </select>
          </div>
          <!-- other reason (conditional) -->
          <div class="other-reason-field" id="otherReasonContainer">
            <label><i class="fas fa-pen"></i> Other description</label>
            <input type="text" id="cityOtherReason" placeholder="specify action...">
          </div>
          <div class="field-row">
            <label><i class="fas fa-note-sticky"></i> Details of Action</label>
            <textarea id="cityDetails" rows="1" placeholder="full description / paragraph"></textarea>
          </div>
          <div class="field-row">
            <label><i class="fas fa-question-circle"></i> Reason for Action</label>
            <input type="text" id="cityReason" placeholder="why this action?">
          </div>
        </div>
      </div>

      <!-- COMMON FIELDS (Officer + Badge) -->
      <div class="field-row">
        <label><i class="fas fa-user-tie"></i> Officer Name</label>
        <input type="text" id="officerName" placeholder="full name" required>
      </div>

      <div class="field-row">
        <label><i class="fas fa-id-badge"></i> Badge Number</label>
        <div style="display: flex; align-items: center; gap: 8px; width: 100%;">
          <span class="badge-hint"><i class="fas fa-lock"></i> CS</span>
          <input type="text" id="badgeNumber" placeholder="two‚Äëdigit number (e.g., 17)" style="flex:1; min-width:140px;" required>
        </div>
      </div>

      <hr class="section-divider">

      <!-- NO IP FIELD ‚Äì REMOVED AS REQUESTED -->

      <div class="submit-area">
        <div id="formResponse" class="response-message"></div>
        <button type="submit" class="submit-btn">
          <i class="fas fa-paper-plane"></i> SUBMIT REPORT
        </button>
      </div>
    </form>
  </div>
</main>

<footer>
  <i class="fas fa-shield"></i> LSCS ¬∑ official action reporting
</footer>

<script>
  (function() {
    const form = document.getElementById('actionForm');
    const responseDiv = document.getElementById('formResponse');
    const actionType = document.getElementById('actionType');
    const card = document.getElementById('actionCard');
    const headerCodeSpan = document.getElementById('headerReportCode');
    const reportCodeInput = document.getElementById('reportCode');

    // random LSCS-XXXX generator (4 digits)
    function randomLSCScode() {
      const rand = Math.floor(Math.random() * 9000 + 1000); // 1000-9999
      return `LSCS-${rand}`;
    }

    function setNewCode() {
      const code = randomLSCScode();
      reportCodeInput.value = code;
      headerCodeSpan.textContent = code;
    }
    setNewCode(); // initial

    // toggling parking / city classes
    function updateVisibility() {
      const val = actionType.value;
      card.classList.remove('show-parking', 'show-city');
      if (val === 'parking') {
        card.classList.add('show-parking');
      } else if (val === 'city') {
        card.classList.add('show-city');
      }
    }
    actionType.addEventListener('change', updateVisibility);
    updateVisibility(); // run on load

    // "Other" reason field toggle for city
    const cityActionSelect = document.getElementById('cityActionTaken');
    const otherContainer = document.getElementById('otherReasonContainer');
    cityActionSelect.addEventListener('change', function() {
      if (this.value === 'Other') {
        otherContainer.classList.add('active');
      } else {
        otherContainer.classList.remove('active');
      }
    });

    // set default datetimes (now)
    function setDefaultDatetime() {
      const now = new Date();
      const year = now.getFullYear();
      const month = String(now.getMonth() + 1).padStart(2,'0');
      const day = String(now.getDate()).padStart(2,'0');
      const hours = String(now.getHours()).padStart(2,'0');
      const minutes = String(now.getMinutes()).padStart(2,'0');
      const value = `${year}-${month}-${day}T${hours}:${minutes}`;
      
      const parkingDT = document.getElementById('parkingTimestamp');
      const cityDT = document.getElementById('cityTimestamp');
      if (parkingDT) parkingDT.value = value;
      if (cityDT) cityDT.value = value;
    }
    setDefaultDatetime();

    // IP FUNCTION REMOVED ‚Äì no IP fetch, no IP field

    // submit handler
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      responseDiv.textContent = '';
      responseDiv.className = 'response-message';

      const type = actionType.value;
      if (!type) {
        responseDiv.textContent = '‚ùå Select Parking Action or City Action.';
        responseDiv.classList.add('response-error');
        return;
      }

      // common
      const officerName = document.getElementById('officerName').value.trim();
      let badgeRaw = document.getElementById('badgeNumber').value.trim();
      const badgeFull = badgeRaw ? `CS-${badgeRaw.padStart(2,'0').slice(0,2)}` : 'CS-??';

      if (!officerName || !badgeRaw) {
        responseDiv.textContent = '‚ùå Officer name and badge number required.';
        responseDiv.classList.add('response-error');
        return;
      }

      // building embed fields (simple lines, no inline limits)
      let fields = [];

      // base report code
      fields.push({ name: 'üìã Report Code', value: reportCodeInput.value, inline: false });

      if (type === 'parking') {
        const dt = document.getElementById('parkingTimestamp').value;
        const loc = document.getElementById('parkingLocation').value.trim();
        const guid = document.getElementById('parkingGuideline').value.trim();
        const vehicle = document.getElementById('parkingVehicle').value.trim();
        const photo = document.getElementById('parkingPhoto').value.trim();

        if (!dt || !loc || !guid || !vehicle || !photo) {
          responseDiv.textContent = '‚ùå Please fill all parking fields.';
          responseDiv.classList.add('response-error');
          return;
        }

        fields.push({ name: 'üïí Date & Time', value: dt.replace('T', ' ¬∑ ') || 'N/A', inline: false });
        fields.push({ name: 'üìç Location', value: loc, inline: false });
        fields.push({ name: 'üìè Guideline', value: guid, inline: false });
        fields.push({ name: 'üöô Vehicle Description', value: vehicle, inline: false });
        fields.push({ name: 'üì∏ Photographic Evidence', value: photo, inline: false }); // full URL
      } 
      else { // city
        const dt = document.getElementById('cityTimestamp').value;
        const loc = document.getElementById('cityLocation').value.trim();
        let actionTaken = document.getElementById('cityActionTaken').value;
        const details = document.getElementById('cityDetails').value.trim();
        const reason = document.getElementById('cityReason').value.trim();

        if (!dt || !loc || !actionTaken || !details || !reason) {
          responseDiv.textContent = '‚ùå Fill all city fields (action, details, reason).';
          responseDiv.classList.add('response-error');
          return;
        }

        // handle "Other" text
        if (actionTaken === 'Other') {
          const otherText = document.getElementById('cityOtherReason').value.trim();
          if (!otherText) {
            responseDiv.textContent = '‚ùå Please specify "Other" action.';
            responseDiv.classList.add('response-error');
            return;
          }
          actionTaken = `Other: ${otherText}`;
        }

        fields.push({ name: 'üïí Date & Time', value: dt.replace('T', ' ¬∑ ') || 'N/A', inline: false });
        fields.push({ name: 'üìç Location', value: loc, inline: false });
        fields.push({ name: 'üî® Action Taken', value: actionTaken, inline: false });
        fields.push({ name: 'üìù Details of Action', value: details, inline: false });
        fields.push({ name: '‚ùì Reason for Action', value: reason, inline: false });
      }

      // common officer and badge (IP removed)
      fields.push({ name: 'üëÆ Officer Name', value: officerName, inline: false });
      fields.push({ name: 'ü™™ Badge Number', value: badgeFull, inline: false });
      // NO IP FIELD

      // Discord embed
      const embed = {
        title: 'LSCS ¬∑ Action Report',
        color: 0xf6861f, // orange
        fields: fields,
        footer: { text: 'Los Santos City Services ¬∑ Reporting' },
        timestamp: new Date().toISOString()
      };

      const webhookURL = 'https://discord.com/api/webhooks/1475979734377693307/2xtdfsR9wPRwNbCc4a8SPVqsnr4Bsc0B2W-ITDN6-k4XAjQb4mSGfXLXkM7Y7EgqT9f0';

      try {
        const res = await fetch(webhookURL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ content: null, embeds: [embed] })
        });

        if (res.ok) {
          responseDiv.textContent = '‚úÖ Action report filed.';
          responseDiv.classList.add('response-success');

          // reset form but keep new random code
          form.reset();
          setNewCode();           // fresh LSCS-XXXX
          setDefaultDatetime();   // set both timestamps to now
          card.classList.remove('show-parking', 'show-city'); // hide dynamic sections
          otherContainer.classList.remove('active'); // hide other
        } else {
          throw new Error(`HTTP ${res.status}`);
        }
      } catch (err) {
        responseDiv.textContent = '‚ùå Discord webhook error.';
        responseDiv.classList.add('response-error');
        console.error(err);
      }
    });
  })();
</script>
</body>
</html>
